{"version":3,"file":"RichEditorTheme.js","sources":["../src/RichEditorTheme.ts"],"sourcesContent":["import Quill from \"quill\";\nimport type { QuillOptionsStatic } from \"quill\";\nimport type BubbleThemeClass from \"quill/themes/snow\";\nimport { RichEditorTooltip } from \"./RichEditorTooltip\";\n\nconst BubbleTheme: typeof BubbleThemeClass = Quill.import(\"themes/snow\");\nconst icons = Quill.import(\"ui/icons\");\n\nconst TOOLBAR_CONFIG = [\n  [{ header: [\"1\", \"2\", \"3\", false] }],\n  [\"bold\", \"italic\", \"underline\", \"strike\"],\n  [{ color: [] }, { background: [] }],\n  [\"code-block\", \"formula\"],\n  [\n    {\n      list: \"ordered\",\n    },\n    {\n      list: \"bullet\",\n    },\n  ],\n  [\n    {\n      align: [],\n    },\n  ],\n  [\"link\", \"image\"],\n  [\"clean\"],\n];\n\nconst BUBBLE_DEFAULTS = BubbleTheme.DEFAULTS as any;\nexport class RichEditorTheme extends BubbleTheme {\n  static DEFAULTS = {\n    ...BUBBLE_DEFAULTS,\n    modules: {\n      ...BUBBLE_DEFAULTS.modules,\n      toolbar: {\n        ...BUBBLE_DEFAULTS.toolbar,\n        handlers: {\n          ...BUBBLE_DEFAULTS.toolbar.handlers,\n          link(value: string) {\n            if (value) {\n              const range = this.quill.getSelection();\n              if (range == null || range.length === 0) return;\n              let preview = this.quill.getText(range);\n              if (\n                /^\\S+@\\S+\\.\\S+$/.test(preview) &&\n                preview.indexOf(\"mailto:\") !== 0\n              ) {\n                preview = `mailto:${preview}`;\n              }\n              this.quill.theme.tooltip.edit(\"link\", preview);\n            } else {\n              this.quill.format(\"link\", false);\n            }\n          },\n        },\n      },\n    },\n  };\n\n  constructor(quill: Quill, options: QuillOptionsStatic) {\n    if (\n      options.modules &&\n      options.modules.toolbar != null &&\n      options.modules.toolbar.container == null\n    ) {\n      options.modules.toolbar.container = TOOLBAR_CONFIG;\n    }\n    super(quill, options);\n    (this.quill as any).container.classList.add(\"ql-rich-editor\");\n  }\n\n  extendToolbar(toolbar: any) {\n    toolbar.container.classList.add(\"ql-rich-editor\");\n\n    this.tooltip = new RichEditorTooltip(this.quill, this.options.bounds);\n    this.tooltip.root.appendChild(toolbar.container);\n\n    this.buildButtons(toolbar.container.querySelectorAll(\"button\"), icons);\n    this.buildPickers(toolbar.container.querySelectorAll(\"select\"), icons);\n  }\n}\n\nQuill.register(\"themes/rich-editor\", RichEditorTheme, true);\n"],"names":["BubbleTheme","Quill","import","icons","TOOLBAR_CONFIG","header","color","background","list","align","BUBBLE_DEFAULTS","DEFAULTS","RichEditorTheme","constructor","quill","options","modules","toolbar","container","super","this","classList","add","extendToolbar","tooltip","RichEditorTooltip","bounds","root","appendChild","buildButtons","querySelectorAll","buildPickers","handlers","link","value","range","getSelection","length","preview","getText","test","indexOf","theme","edit","format","register"],"mappings":"4HAKA,MAAMA,EAAuCC,EAAMC,OAAO,eACpDC,EAAQF,EAAMC,OAAO,YAErBE,EAAiB,CACrB,CAAC,CAAEC,OAAQ,CAAC,IAAK,IAAK,KAAK,KAC3B,CAAC,OAAQ,SAAU,YAAa,UAChC,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,aAAc,WACf,CACE,CACEC,KAAM,WAER,CACEA,KAAM,WAGV,CACE,CACEC,MAAO,KAGX,CAAC,OAAQ,SACT,CAAC,UAGGC,EAAkBV,EAAYW,eACvBC,UAAwBZ,EA8BnCa,YAAYC,EAAcC,GAEtBA,EAAQC,SACmB,MAA3BD,EAAQC,QAAQC,SACqB,MAArCF,EAAQC,QAAQC,QAAQC,YAExBH,EAAQC,QAAQC,QAAQC,UAAYd,GAEtCe,MAAML,EAAOC,GACZK,KAAKN,MAAcI,UAAUG,UAAUC,IAAI,kBAG9CC,cAAcN,GACZA,EAAQC,UAAUG,UAAUC,IAAI,kBAEhCF,KAAKI,QAAU,IAAIC,EAAkBL,KAAKN,MAAOM,KAAKL,QAAQW,QAC9DN,KAAKI,QAAQG,KAAKC,YAAYX,EAAQC,WAEtCE,KAAKS,aAAaZ,EAAQC,UAAUY,iBAAiB,UAAW3B,GAChEiB,KAAKW,aAAad,EAAQC,UAAUY,iBAAiB,UAAW3B,IAhD3DS,0CACFF,IACHM,uCACKN,EAAgBM,UACnBC,uCACKP,EAAgBO,UACnBe,wCACKtB,EAAgBO,QAAQe,WAC3BC,KAAKC,GACH,GAAIA,EAAO,CACT,MAAMC,EAAQf,KAAKN,MAAMsB,eACzB,GAAa,MAATD,GAAkC,IAAjBA,EAAME,OAAc,OACzC,IAAIC,EAAUlB,KAAKN,MAAMyB,QAAQJ,GAE/B,iBAAiBK,KAAKF,IACS,IAA/BA,EAAQG,QAAQ,aAEhBH,EAAU,UAAUA,KAEtBlB,KAAKN,MAAM4B,MAAMlB,QAAQmB,KAAK,OAAQL,QAEtClB,KAAKN,MAAM8B,OAAO,QAAQ,YA+BxC3C,EAAM4C,SAAS,qBAAsBjC,GAAiB"}